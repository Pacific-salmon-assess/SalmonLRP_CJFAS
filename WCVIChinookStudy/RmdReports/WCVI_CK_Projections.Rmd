---
title: 'WCVI Chinook Projection-based LRPs'
author: "Carrie Holt"
date: "7/9/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = normalizePath(".."))  


library(tidyverse)
library(ggplot2)
library(viridis)
library(corrplot)

```


This report describes  projection-based limit reference points (LRPs) for WCVI Chinook salmon and describes the parameterization of key components of the forward projections. A table describing all base-case parameter assumptions is availalble on DropBox:   <https://www.dropbox.com/home/Limit%20Reference%20Point%20-%20TWG%20materials/Case%20Study%20Results/WCVI%20Chinook?preview=ProjectionBasedLRP-Parameters.pdf>. Parameters were either estimated from a run reconstruction for WCVI Chinook (D. Dosbon pers. comm.), estimated from the Watershed-Area model (Parken et al. 2006), or derived from a life-stage model with expert opinion (W. Luedke pers. comm.).

For observed data, only indicator stocks that are not heavily enhanced were included when deriving inlet-level spawner abundances (PNI>0.5). We only included years where all indicators were monitored (i.e., we did not infill). In future work,infilled time-series within inlets could be developed to extend the time-series. Figure 1 shows time-series of inlet-specific spawner abundances (indicators with PNI > 0.5) for the time period where abundances from all indicators are available. Only inlets with natural indicator stocks were included in the analyses, resulting in 5 inlets covering all 3 WCVI CUs.

```{r echo=FALSE, fig.cap = "**Figure 1**. Time series of spawner abundances by inlet for indicator WCVI Chinook stocks with average PNI >0.5. "}
setwd('..')
rootDir<-getwd()
codeDir<-paste(rootDir,"/Code",sep="")
wcviCKDir<-paste(rootDir,"/WCVIChinookStudy",sep="")
setwd(wcviCKDir)

Inlet_Sum.df.long <- read.csv("DataIn/Inlet_Sum.csv")
ggplot(Inlet_Sum.df.long %>% filter(BroodYear>1996), aes(BroodYear, Spawners, group=Inlet_Name, colour=Inlet_Name))+geom_line()

# from 1996 onwards, but includes years when some CUs are missing (which are not included in corr)

SpawnerInlets <- ggplot(data =  Inlet_Sum.df.long %>% filter(BroodYear>1996), 
       aes(BroodYear, Spawners, group=Inlet_Name, colour=Inlet_Name))+geom_line()


```


## Parameterization
We chose parameters that resulted in projections of inlet-specific spawner abundances with correlations among inlets that were similar to observed correlations among inlets (Fig. 2). Specifically, model parameters were adjusted so that resulting correlations among inlets in simulated spawner abundances approximately matched the observed correlations in spawner abundances among inlets.

While there is evidence for correlations between observed spawner time-series early in the 1990s and early 2000s, these correlations have become weaker >2015.  The correlations among inlets for running 20-year time periods are shown in Figure 2. Starting in 1993, the first boxplot shows the distribution of pair-wise correlations among the 5 inlets (n=10 pairwise correlations) for the time-period 1993-2013, and the second box-plot shows correlations 1994-2014, etc.. A decline in correlations in evident in the last two time periods. The final boxplot shows the correlation over the entire time-series.

```{r echo=FALSE, fig.cap = "**Figure 2**. Running correlations among inlets within 20-year time periods, with the start year of the 20-year period on the X-axis. Each boxplot shows the distribution of pairwise correlations among the 5 inlets (n=10 pairwise correlations)."}

Years <- 1995:2000
tri <- matrix(NA, nrow=10,ncol=length(Years))
med <- NA

#Estimate correlatoin over 2o-year periods running from 1995 to 2000.
for (i in 1:length(Years)){
  Year.Start <- Years[i]
  Inlet_Sum.df <-   Inlet_Sum.df.long %>% 
    filter(BroodYear %in% c(Year.Start : (Year.Start + 20) ) ) %>% 
    dplyr::select(-c(CU_Name, Inlet_ID, Recruits)) %>% 
    pivot_wider(id_cols= c (Inlet_Name, BroodYear), 
                names_from=Inlet_Name, values_from=Spawners) %>% 
    dplyr::select(-BroodYear) %>% na.omit()
  
  co <- cor(Inlet_Sum.df)
  tri[,i] <- co[lower.tri(co)==TRUE]
  med[i] <- median(co[lower.tri(co)==TRUE])  
}

dum <- as.data.frame(tri)
names(dum) <- as.character(Years)
tri_longer <- dum %>% pivot_longer(col=names(dum), names_to="StartYear", 
                                   values_to="Correlation")
tri_longer$StartYear <- factor(tri_longer$StartYear, levels = names(dum), 
                               ordered = TRUE)

# Add overall correlation (over all years)
Inlet_Sum.df.all <-   Inlet_Sum.df.long %>% 
  dplyr::select(-c(CU_Name, Inlet_ID, Recruits)) %>% 
  pivot_wider(id_cols=c(Inlet_Name, BroodYear), names_from=Inlet_Name, 
              values_from=Spawners) %>% dplyr::select(-BroodYear) %>% na.omit()
co <- cor(Inlet_Sum.df.all)
tri.all <- data.frame(StartYear="All", Correlation= co[lower.tri(co)==TRUE])
tri_longer <- tri_longer %>% add_row(tri.all)

# Plot of running 20-year correlations among inlets, over the time series 1953-2020
RunningCor <- ggplot(tri_longer, aes(x=StartYear, y=Correlation)) + 
  geom_boxplot() + 
  theme(axis.text.x = element_text(angle = 45, vjust = 0.9, hjust=1))

RunningCor

```



Within the forward projection model, correlations in spawner abundances among inlets are driven by three model components each described in more detail below: (1) covariance in exploitation rates among inlets, which is determined from a common interannual exploitation (due to shared exploitation histories off shore, parameterized from pre-terminal exploitation on Robertson Creek hatchery fish) and an additional inlet-specific variability in exploitation, (2) covariance in recruitment residuals among inlets, and (3) covariance in age proportions of recruits. 

## (1) Covariance in exploitation
We assumed an average exploitation rate as observed for wCVI Chinook in recent years (2010-2020, Robertson Creek indicator, 29%), with common interannual variability in exploitation rates due to shared exploitation history offshore. Interannual variability in exploitation rates was assumed to be beta distributed (constrained between 0 and 1), parameterized from estimated pre-terminal exploitation rates for Robertson Creek hatchery fish (from run reconstruction, D. Dobson, pers. comm.), with a coefficient of variation (cv) = 0.42. Without data to parameterize inlet-specific variability in exploitation rates, we assumed the inlet-specific interannual variability was half the common (SMU-level) interannual variability (cv=0.21), but varied this in sensitivity analyses to 0 and 0.42 to cover plausible bounds. Figure 3 shows the distribution of realized exploitation rates around a given target exploitation rate of 0.3, for two levels of variability, cv = 0.42 and cv = 0.21 (the third level cv=0 represents no variability in exploitation), and a combined common interannual variability x inlet-specific variability (0.42 x 0.21 and 0.42 x 0.42).  An example time-series of common interannaul variability in exploitation rates (blue line), and inlet-specific variablity around that common trend (green lines) is is shown in Fig. 4. We assumed that inlets were either consistently under or overharvestd over the entire time-series (e.g., due to the spatial and temporal variability in inlet-specific migration patterns affecting vulnerability to fisheries), but that this bias changed over MC trials.

```{r echo=FALSE, fig.cap = "**Figure 3**. Variability in simulated exploitation rates over time (cv=0.42) and among inlets (cv=0.21), from the average explotation of 0.29."}
nTrials <- 100000
canERlabel <- 0.29
set.seed(100)

# Density of ERs with cvER=0.21 (either interannual or among CUs)
canER <- canERlabel
cvER <- 0.21
sigCanER <- cvER*canER
shape1 <- canER^2 * (((1-canER)/sigCanER^2)-(1/canER))
shape2 <-shape1 * (1/canER-1)
out1 <- rbeta(nTrials,shape1,shape2)

# Density of ERs with cvER=0.42
cvER <- 0.42
sigCanER <- cvER*canER
shape1 <- canER^2 * (((1-canER)/sigCanER^2)-(1/canER))
shape2 <-shape1 * (1/canER-1)
out2 <- rbeta(nTrials,shape1,shape2)

#Density of ERs with cvER=0.42 interannually and 0.21 among CUs
canER <- out2
cvER <- 0.21
sigCanER <- cvER*canER
shape1 <- canER^2 * (((1-canER)/sigCanER^2)-(1/canER))
shape2 <- shape1 * (1/canER-1)


sampBeta<-function(nTrial) {
  # If assuming among CU variability changes every year
  #x<-rbeta(1,shape1[nTrial],shape2[nTrial])
  
  # If assuming among CU variability is constant over time
  x<-qbeta(rand,shape1[nTrial],shape2[nTrial])
}

randCU <- runif(5)

rand <- randCU[1]
out3 <- sapply(1:nTrials,sampBeta)
rand <- randCU[2]
out3b <- sapply(1:nTrials,sampBeta)
rand <- randCU[3]
out3c <- sapply(1:nTrials,sampBeta)
rand <- randCU[4]
out3d <- sapply(1:nTrials,sampBeta)
rand <- randCU[5]
out3e <- sapply(1:nTrials,sampBeta)

#Density of ERs with cvER=0.42 interannually and 0.42 among CUs
canER <- out2
cvER <- 0.42
sigCanER <- cvER*canER
shape1 <- canER^2 * (((1-canER)/sigCanER^2)-(1/canER))
shape2 <- shape1 * (1/canER-1)

rand <- randCU[1]
out4<-sapply(1:nTrials,sampBeta)

out <- data.frame( cvER = c(rep("0.21",nTrials), rep("0.42",nTrials),
                            rep("0.21 x 0.42",nTrials), rep("0.42 x 0.42",nTrials)),
                   ExploitationRate = c(out1, out2, out3, out4) )



g1 <- out %>% dplyr::filter(cvER=="0.21") %>%
  ggplot(aes(ExploitationRate, colour = cvER, fill = cvER)) +
  geom_density (alpha = 0.1) +
  geom_vline (xintercept = canERlabel) +
  xlim (0,1) +
  theme(axis.title.x = element_text(size=18),
    axis.title.y = element_text(size=18))

g1b <- out %>% dplyr::filter(cvER=="0.21") %>%
  ggplot(aes(ExploitationRate, colour = cvER, fill = cvER)) +
  geom_density (alpha = 0.1, size=3) +
  geom_vline (xintercept = canERlabel) +
  xlim (0,1) + theme(legend.position="none", panel.grid = element_blank(),
                     axis.title.x = element_blank(),
                     axis.title.y = element_blank(),
                     axis.text.x = element_blank(),
                     axis.text.y = element_blank())


g2 <- out %>% dplyr::filter(cvER=="0.21"|cvER=="0.42") %>%
  ggplot(aes(ExploitationRate, colour = cvER, fill = cvER)) +
  geom_density (alpha = 0.1) +
  xlim (0,1) +
  geom_vline (xintercept = canERlabel) +
  theme(axis.title.x = element_text(size=18),
        axis.title.y = element_text(size=18))

g2b <- out %>% dplyr::filter(cvER=="0.42") %>%
  ggplot(aes(ExploitationRate)) +
  geom_density (alpha = 0.1, size=3, colour="aquamarine3", fill="aquamarine3") +
  geom_vline (xintercept = canERlabel) +
  xlim (0,1) + ylim(0,6.5) +
  theme(legend.position="none", panel.grid = element_blank(),
                     axis.title.x = element_blank(),
                     axis.title.y = element_blank(),
                     axis.text.x = element_blank(),
                     axis.text.y = element_blank())


g3 <- out %>% dplyr::filter(cvER=="0.21"|cvER=="0.42"|cvER=="0.21 x 0.42") %>%
  ggplot(aes(ExploitationRate, colour = cvER, fill = cvER)) +
  geom_density (alpha = 0.1) +
  xlim (0,1) +
  geom_vline (xintercept = canERlabel) +
  theme(axis.title.x = element_text(size=18),
        axis.title.y = element_text(size=18))


g4 <- out %>%
  ggplot(aes(ExploitationRate, colour = cvER, fill = cvER)) +
  geom_density (alpha = 0.1) +
  xlim (0,1) +
  geom_vline (xintercept = canERlabel) +
  theme(axis.title.x = element_text(size=18),
        axis.title.y = element_text(size=18))
g2

```


```{r echo=FALSE, warning=FALSE, message=FALSE, error=FALSE, fig.cap = "**Figure 4**. Example simulated time-series of exploitation rates with interannual and inlet-specific variability"}


lineAggData <- out %>% dplyr::filter(cvER=="0.42") %>% slice(1:20)  %>% add_column(Year=1:20) %>% add_column(Label="SMU")


inletLineData <- out %>% dplyr::filter(cvER=="0.21 x 0.42") %>% slice(1:20) %>% add_column(Year=1:20) %>% add_column(Label="Inlet")
inletLineDatab <- data.frame(Label="Inletb", Year=1:20, ExploitationRate=out3b[1:20], cvER="0.21 x 0.42")
inletLineDatac <- data.frame(Label="Inletc", Year=1:20, ExploitationRate=out3c[1:20], cvER="0.21 x 0.42")
inletLineDatad <- data.frame(Label="Inletd", Year=1:20, ExploitationRate=out3d[1:20], cvER="0.21 x 0.42")
inletLineDatae <- data.frame(Label="Inlete", Year=1:20, ExploitationRate=out3e[1:20], cvER="0.21 x 0.42")
inletLineData <- inletLineData %>% add_row(inletLineDatab) %>% add_row(inletLineDatac) %>% add_row(inletLineDatad) %>% add_row(inletLineDatae)
lineAggData <- lineAggData %>% add_row(inletLineData) %>% dplyr::select(-cvER)


g5 <- lineAggData %>% filter(Label == "SMU") %>%
  ggplot(aes(Year, ExploitationRate, colour=Label)) +
  scale_colour_manual(values=viridis(3)[1]) +
  ylim(0,0.75)+
  geom_line(size=2) +
  theme(axis.title.x=element_text(18),
        axis.title.y=element_text(18))
#g5


g6 <- lineAggData %>% filter(Label=="SMU"|Label=="Inlet") %>% ggplot(aes(Year, ExploitationRate, colour=Label)) +
  scale_colour_manual(values=c(viridis(3)[2],viridis(3)[1])) +
  geom_line(size=2) +
  ylim(0,0.75)+
  theme(axis.title.x=element_text(18),
        axis.title.y=element_text(18))

#g6

g7 <- lineAggData  %>% ggplot(aes(Year, ExploitationRate, colour=Label)) +
  scale_colour_manual(values=c(rep(viridis(3)[2],5),viridis(3)[1])) +
  geom_line(size=2) +
  ylim(0,0.75)+
  theme(axis.title.x=element_text(18),
        axis.title.y=element_text(18))

g7




```
In the forward projection model, pairwise correlations in simulated spawner abundances among inlets tended to be similar to observed pairwise correlations in spawner abundances among inlets (Fig. 5). Varying assumptions about variability in exploitation among inlets from the base case (cv = 0.21) lower to zero or as high as 0.42 resulted in a change in the range of simulated pairwise spawner correlations (higher cv in exploitation resulted in higher range in simulated correlations), but not the median correlation.  Provisional LRPs at p = 0.5 (50% probability that all inlets are above lower benchmarks) are similar to the base case when  variability in ERs among inlets is reduced to 0 (11,700) and increases by ~1000 fish (to 12,900) when that variability is increased to 0.42. As expected, higher variabilty results in a higher LRP.

```{r echo=FALSE, fig.cap="**Figure 5**. Distribution of correlations of spawner abundances among inlets for observed data (n=10 pairwise correlations) and simulated time-series, with cv in exploitation rates among inlets = 0, 0.21 or 0.42 (0.42 is equal to the estimated interannual variablity in exploitation rates). ", out.width = '60%'}
knitr::include_graphics(paste(wcviCKDir,"/Figures/ProjectedLRPs/compareEscCor_cvER0.21age.png",sep=""))
#knitr::include_graphics("Figures/ProjectedLRPs/compareEscCor_cvER.png")

# Consider adding another run with annualcvER=FALSE (cvER =0.21) in Appendix
```


## (2) Covariance in recruitment residuals
We parameterized correlations in recruitment residuals among inlets from the correlations in spawner abundances among inlets (derived from WCVI Chinook run reconstruction, D. Dobson, pers. comm. Fig. 6). In sensitivity analyses, we scaled the pairwise correlations in recruitment residuals among inlets between 1 (correlations in recruitment residuals within the model = observed correlations in spawners) and 0 (recruitment residuals being uncorrelated among inlets within the model), in increments of 0.1.


```{r echo=FALSE, fig.cap="**Figure 6**. Bubble plot of correlations in spawner abundances among inlets over time."}


wcviCKSRDat <- read.csv(paste(wcviCKDir, "/DataIn/Inlet_Sum.csv", sep=""))
wcviCKSRDat$yr_num <- group_by(wcviCKSRDat,BroodYear) %>% group_indices() - 1 # have to subtract 1 from integer so they start with 0 for TMB/c++ indexing
wcviCKSRDat$CU_ID <- group_by(wcviCKSRDat, Inlet_ID) %>% group_indices() - 1 # have to subtract 1 from integer so they start with 0 for TMB/c++ indexing
dum <- wcviCKSRDat %>% dplyr::select(CU_ID, BroodYear, Spawners)
dum <- dum %>% pivot_wider(id_cols=c(CU_ID, BroodYear), names_from=CU_ID,
                           values_from=Spawners) %>% dplyr::select (!BroodYear)
dum <- dum %>% drop_na()
corMat <- cor(dum)

rownames(corMat) <- read.csv(paste(wcviCKDir, "SamSimInputs/CUPars.csv",sep="/"))$stkName
colnames(corMat) <- read.csv(paste(wcviCKDir, "SamSimInputs/CUPars.csv",sep="/"))$stkName

# png(filename=paste(wcviCKDir, "/Figures/SpawnerCorrelation.png", sep=""), width=4, height=4.5, units="in", res=500)
par(xpd=TRUE)
corrplot(corMat, method="circle", p.mat=corMat, insig="p-value", type="lower")
# dev.off()
```

When we assumed correlations in recruitment residuals equal to observed spawner correlations (i.e., scalar = 1) the resulting in simulated spawner correlations matched observed correlations (Fig. 7). Scaling the recruitment residuals resulted in simulated spawner correlations that were lower than those observed. 


```{r echo=FALSE, fig.cap="**Figure 7**. Distribution of correlations of spawner abundances among inlets for observed data (n=10 pairwise correlations) and simulated time-series, assuming a scalar on covariance in recruitment residuals from 1 (equal to observed spawner correlations) to 0 (no correlation in recruitment residuals), in increments of 0.1. Projections assume a cv in exploitation rates among inlets = 0.21 (half that of estimated interannual variablity in exploitation rates). ", out.width = '60%'}
 knitr::include_graphics(paste(wcviCKDir,"/Figures/ProjectedLRPs/compareEscCor_cvER0.21age.png",sep=""))
#knitr::include_graphics(paste("Figures/ProjectedLRPs/compareEscCor_cvER0.21.png",sep=""))



```



## (3) Variability in age proportions among inlets

For the base case, we assumed that age proportions of recruits varied over time and among inlets, based on estimated age proportions of recruitment (aligned by brood year) calculated for each CU in the WCVI Chinook run reconstruction (SWVI, Nookta & Kyuquot, and NWVI; run reconstructions were not available at the inlet level; D. Dobson pers. comm.) (Fig. 8). Specifically, we assumed the mean proportions at each age from the run reconstructions for each CU and annual deviations in those proportions were based on a multivariate logistic distribution parameterized from the estimated time-series of age proportions (Fig. 9).
```{r echo=FALSE, fig.cap="**Figure 8**. Time-series of proportions at age in recruitment aligned by brood year, calculated from run reconstruction for West Coast of Vancouver Island Chinook by CU."}
cuAges <- read.csv(paste(wcviCKDir, "/DataIn/CUages.csv", sep=""))
cuAges <- cuAges %>% pivot_longer(cols=c("age2", "age3", "age4", "age5"),
                                  names_to="Age", values_to="Proportion")

cuAges$CU_Names. <- factor(cuAges$CU_Names,
                            levels=c("Southwest_Vancouver_Island",
                                     "Nootka_Kyuquot",
                                     "Northwest_Vancouver_Island",
                                     "Westcoast_Vancouver_Island"))

cuAges %>% filter(CU_Names!="Westcoast_Vancouver_Island") %>%
  ggplot(aes(Year, Proportion, group=CU_Names., colour=CU_Names.)) +
  geom_line() + 
  facet_wrap(~Age, ncol=1)
# If required, consider adding geom_density of pairwise correlations in estimated age ppns of recruits

```


We ran a sensitivity analysis under an alternative assumption that age proportions varied over years but were constant among inlets. Under this alternative assumption, we found that pairwise correlations of simulated spawner abundances were much higher than those observed (Fig. 9), generating time-series that were unrealistic. 

```{r echo=FALSE, fig.cap="**Figure 9**. Distribution of correlations of spawner abundances among inlets for observed data (n=10 pairwise correlations) and simulated time-series, for the assumption of variable age proportions among inlets and constant proportions among inlest. Projections assume a cv in exploitation rates among inlets = 0.21 (half that of estimated interannual variablity in exploitation rates).", out.width = '60%'}
 knitr::include_graphics(paste(wcviCKDir,"/Figures/ProjectedLRPs/compareEscCor_cvER0.21age.png",sep=""))
#knitr::include_graphics(paste("Figures/ProjectedLRPs/compareEscCor_cvER0.21.png",sep=""))



```

## LRPs
Projection-based LRPs were developed under the assumption of current average Assuming base case of (1) interannual variability in exploitation rates among inlets with a cv = 0.21, (2) correlations in recruitment residuals among inlets equal to  observed spawner correlations among inlets, and (3) variability in age proportions among inlets, we identified a provisional aggregate abundance LRP with p=0.5 (50% probability of all inlets being greater than their lower benchmark) equal to `r (read.csv(paste(wcviCKDir, "/DataOut/ProjectedLRPs/ProjectedLRPscvER0.21baseER_ALLp.csv", sep=""))%>% pull(LRP))[1]`(Fig. 1). Provisional LRPs at p=0.66 ("likely" that all inlets are above their lower benchmarks) is also provided (Fig. 10). Probabilities did not exceed 0.9 so LRPs at higher p values could not be estimated.
```{r echo=FALSE, fig.cap="**Figure 10**. Probability of all inlets being above their lower benchmark vs aggregate abundances from projections over 30 years and 50,000 MC Trials, assuming variability in ER's among inlets with cv=0.21. LRPs at 2 probability values are highlighted, p=0.5 (yellow) and p=0.66 (pale green). Probabilities of all inlets being above lower benchmarks did not exceed 90 and 99%, so LRPs at those p-values could not be evaluated. Each dot is the proportion of MC trials where all inlets were > lower benchmarks for a bin of 200 fish aggregate abundances. Note, LRPs at p = 0.66 require more MC trials for full stabilization.", out.width = '60%'}
# Figure of logistic curve all p values for base case
knitr::include_graphics(paste(wcviCKDir,"/Figures/ProjectedLRPs/cvER0.21baseER_ProjLRPCurve_ALLp.png",sep=""))

#(read.csv(paste(wcviCKDir, "/DataOut/ProjectedLRPs/ProjectedLRPs_cvER.csv", sep=""))%>% pull(LRP))[2]

```

We considered sensitivity analyses on interannual variabilty in exploitation rates among inlets with cv = 0 and 0.42 (Figs. 11 and 12).
```{r echo=FALSE, fig.cap="**Figure 11**. Probability of all inlets being above their lower benchmark vs aggregate abundances from projections over 30 years and 10,000 MC Trials, assuming variability in ER's among inlets with cv=0. LRPs at 2 probability values are highlighted, p=0.5 (yellow, 11,700) and p=0.66 (pale green, 12,900). Probabilities of all inlets being above lower benchmarks did not exceed 90 and 99%, so LRPs at those p-values could not be evaluated. Each dot is the proportion of MC trials where all inlets were > lower benchmarks for a bin of 200 fish aggregate abundances. Note, LRPs at p = 0.66 require more MC trials for full stabilization.", out.width = '60%'}

knitr::include_graphics(paste(wcviCKDir,"/Figures/ProjectedLRPs/cvER0.42_ProjLRPCurve_ALLp.png",sep=""))

```
```{r echo=FALSE, fig.cap="**Figure 12**. Probability of all inlets being above their lower benchmark vs aggregate abundances from projections over 30 years and 10,000 MC Trials, assuming variability in ER's among inlets with cv=0.42. LRPs at 2 probability values are highlighted, p=0.5 (yellow, 12,900) and p=0.66 (pale green, 23,700). Probabilities of all inlets being above lower benchmarks did not exceed 90 and 99%, so LRPs at those p-values could not be evaluated. Each dot is the proportion of MC trials where all inlets were > lower benchmarks for a bin of 200 fish aggregate abundances. Note, LRPs at p = 0.66 require more MC trials for stabilization.", out.width = '60%'}
# Figure of logistic curve all p values for base case
knitr::include_graphics(paste(wcviCKDir,"/Figures/ProjectedLRPs/cvER0_ProjLRPCurve_ALLp.png",sep=""))
```

For the base case, the LRPs were compared against time-series of aggregate abundances observed for WCVI Chinook salmon (sum of indicator stocks with PNI > 0.5), showing that abundances are currently below these LRPs and have been near or below them over the available time-series.

```{r echo=FALSE, fig.cap="**Figure 13**. Time-series of aggregate escapement for WCVI Chinook (indicator stocks with PNI > 0.5), with LRPs atprobabilities = 50% and 66% of component inlets being > lower benchmarks: p=0.5 (yellow), p=0.66 (pale green)."}
# Plot of aggretate time series with 4 LRPs (4 p-values)

knitr::include_graphics(paste(wcviCKDir,"/Figures/WCVI_SMUtimeseries_projLRPcvER0.21pValues_noEnh.png",sep=""))

```
   
   
   
